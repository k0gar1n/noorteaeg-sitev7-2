<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Lastekaitsepäev — MTÜ Noorteaeg</title>

  <link rel="stylesheet" href="../assets/site.css">
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    /* Lightbox */
    .lightbox-backdrop{position:fixed;inset:0;background:rgba(0,0,0,.9);
      display:flex;align-items:center;justify-content:center;
      opacity:0;pointer-events:none;transition:.2s;z-index:50}
    .lightbox-backdrop.open{opacity:1;pointer-events:auto}
    .lightbox-img{max-width:90vw;max-height:90vh;border-radius:.5rem}
    .lightbox-close,.lightbox-nav{position:fixed;color:#fff;font-size:2.25rem;
      line-height:1;cursor:pointer;user-select:none;z-index:60}
    .lightbox-close{top:16px;right:22px}
    .lightbox-prev{left:18px}
    .lightbox-next{right:18px}
  </style>
</head>
<body class="bg-gray-50 text-gray-900">

  <!-- Шапка -->
  <header class="border-b bg-white">
    <div class="max-w-5xl mx-auto px-4 py-3 flex items-center justify-between">
      <a href="../index.html#projects" class="text-blue-600" data-i18n="back_to_projects">← Назад к проектам</a>
      <a href="../index.html" class="font-semibold">MTÜ Noorteaeg</a>
    </div>
  </header>

  <!-- Контент -->
  <main class="max-w-5xl mx-auto px-4 py-10">
    <h1 class="text-3xl font-bold" data-i18n="proj_laste_title">Lastekaitsepäev Narva-Jõesuu linnas</h1>
    <p class="mt-4 leading-relaxed" data-i18n="proj_laste_desc">
      Ежегодный городской праздник ко Дню защиты детей: бесплатные батуты, мастер-классы безопасности с Päästeamet и Politsei, творческие зоны и эстафеты. Цель — объединить семьи и показать, что в Нарва-Йыэсуу детям интересно и безопасно.
    </p>

    <section class="mt-8">
      <h2 class="text-2xl font-semibold" data-i18n="photos_title">Фотографии</h2>
      <!-- Галерея сгенерируется скриптом -->
      <div id="gallery" class="grid grid-cols-2 md:grid-cols-3 gap-3 mt-4"></div>
    </section>
  </main>

  <!-- Лайтбокс -->
  <div id="lightbox" class="lightbox-backdrop" aria-hidden="true">
    <span class="lightbox-close" id="lb-close">×</span>
    <span class="lightbox-nav lightbox-prev" id="lb-prev">‹</span>
    <img class="lightbox-img" id="lb-img" alt="">
    <span class="lightbox-nav lightbox-next" id="lb-next">›</span>
  </div>

  <!-- I18N -->
  <script>
    const DICT = {
      ru:{
        back_to_projects:"← Назад к проектам",
        photos_title:"Фотографии",
        proj_laste_title:"Lastekaitsepäev Narva-Jõesuu linnas",
        proj_laste_desc:"Ежегодный городской праздник ко Дню защиты детей: бесплатные батуты, мастер-классы безопасности с Päästeamet и Politsei, творческие зоны и эстафеты. Цель — объединить семьи и показать, что в Нарва-Йыэсуу детям интересно и безопасно."
      },
      et:{
        back_to_projects:"← Tagasi projektide juurde",
        photos_title:"Fotod",
        proj_laste_title:"Lastekaitsepäev Narva-Jõesuu linnas",
        proj_laste_desc:"Iga-aastane linnapidu lastekaitsepäeval: tasuta batuudid, Päästeameti ja Politsei ohutuse töötoad, loovtsoonid ja teatevõistlused. Eesmärk on peresid kokku tuua ning näidata, et Narva-Jõesuus on lastel põnev ja turvaline."
      }
    };
    (function applyI18n(){
      const lang=localStorage.getItem('lang')||'ru';
      document.documentElement.lang=lang;
      document.querySelectorAll('[data-i18n]').forEach(el=>{
        const k=el.getAttribute('data-i18n');
        if (DICT[lang] && DICT[lang][k]) el.textContent = DICT[lang][k];
      });
    })();
  </script>

  <!-- Генерация 200 фото: assets/lastekaitsepaev/1.jpg ... 200.jpg -->
  <script>
    // Папка с фото (относительно этого файла)
    const set = { path: "../assets/lastekaitsepaev/", from: (200), to: (1) };
    const exts = ["jpg","jpeg","png","webp"]; // допустимые расширения

    (function buildGallery(){
      const box = document.getElementById("gallery");
      const step = set.from >= set.to ? -1 : 1;

      for (let n=set.from; step<0 ? n>=set.to : n<=set.to; n+=step){
        const img = document.createElement("img");
        img.className = "rounded-lg img-card lb-gallery";
        img.loading = "lazy"; img.decoding = "async"; img.alt = "";
        img.src = set.path + n + ".jpg";
        img.onerror = function tryNext(){
          const curExt = (this.src.split(".").pop()||"").toLowerCase();
          const idx = exts.indexOf(curExt);
          for (let i=1;i<=exts.length;i++){
            const candidate = set.path + n + "." + exts[(idx+i)%exts.length];
            if (candidate !== this.src){ this.onerror=null; this.src=candidate; break; }
          }
        };
        box.appendChild(img);
      }
    })();
  </script>

  <!-- Лайтбокс -->
  <script>
    const lb=document.getElementById('lightbox');
    const lbImg=document.getElementById('lb-img');
    const prev=document.getElementById('lb-prev');
    const next=document.getElementById('lb-next');
    let list=[], idx=0;

    function refreshList(){ list=[...document.querySelectorAll('img.lb-gallery')].map(i=>i.src); }
    function openL(src){ if(!list.length) refreshList(); idx=list.indexOf(src); if(idx<0) idx=0; lbImg.src=list[idx]; lb.classList.add('open'); }

    document.body.addEventListener('click',e=>{
      if(e.target.matches('img.lb-gallery')) openL(e.target.src);
      if(e.target===lb || e.target.id==='lb-close') lb.classList.remove('open');
    });
    prev.onclick = ()=>{ if(!list.length) return; idx=(idx-1+list.length)%list.length; lbImg.src=list[idx]; };
    next.onclick = ()=>{ if(!list.length) return; idx=(idx+1)%list.length;       lbImg.src=list[idx]; };
    document.addEventListener('keydown',e=>{
      if(!lb.classList.contains('open')) return;
      if(e.key==='Escape') lb.classList.remove('open');
      if(e.key==='ArrowLeft') prev.onclick();
      if(e.key==='ArrowRight') next.onclick();
    });
  </script>
</body>
</html>
